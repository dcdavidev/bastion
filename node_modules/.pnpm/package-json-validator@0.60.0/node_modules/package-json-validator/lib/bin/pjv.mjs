#!/usr/bin/env node
import { validate } from "../validate.mjs";
import fs from "node:fs";
import process from "node:process";
import yargs from "yargs";

//#region src/bin/pjv.ts
/**
* Command line interface for package-json-validator.
* For command line options, try --help
* See README.md for more information
*/
const options = yargs(process.argv.slice(2)).options("filename", {
	alias: "f",
	default: "package.json",
	description: "package.json file to validate"
}).options("warnings", {
	alias: "w",
	boolean: true,
	default: false,
	description: "display warnings"
}).options("recommendations", {
	alias: "r",
	boolean: true,
	default: false,
	description: "display recommendations"
}).options("quiet", {
	alias: "q",
	boolean: true,
	default: false,
	description: "less output"
}).usage("Validate package.json files").parse();
if (!options.quiet) console.warn("The pjv CLI in package-json-validator is deprecated and will be removed soon. Please use package-json-validator-cli instead.");
if (!fs.existsSync(options.filename)) {
	console.error("File does not exist: " + options.filename);
	process.exitCode = 1;
} else {
	const results = validate(fs.readFileSync(options.filename).toString(), {
		recommendations: options.recommendations,
		warnings: options.warnings
	});
	if (results.valid) {
		if (!options.quiet) console.log(results);
	} else {
		console.error(options.filename + " is NOT valid");
		console.error(results);
		process.exitCode = 1;
	}
}

//#endregion
export {  };