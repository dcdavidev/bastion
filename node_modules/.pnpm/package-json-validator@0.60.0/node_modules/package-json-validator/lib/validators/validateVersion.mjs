import { Result } from "../Result.mjs";
import { valid } from "semver";

//#region src/validators/validateVersion.ts
/**
* Validate the `version` field in a package.json, using `semver`.
*/
const validateVersion = (version) => {
	const result = new Result();
	if (typeof version !== "string") if (version === null) result.addIssue("the value is `null`, but should be a `string`");
	else {
		const valueType = Array.isArray(version) ? "Array" : typeof version;
		result.addIssue(`the type should be a \`string\`, not \`${valueType}\``);
	}
	else if (version.trim() === "") result.addIssue("the value is empty, but should be a valid version");
	else if (!valid(version)) result.addIssue("the value is not a valid semver version");
	return result;
};

//#endregion
export { validateVersion };